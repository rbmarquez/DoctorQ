'use client';import{useState}from'react';import{Calendar,Clock,User,MapPin,DollarSign,Check,X,MoreVertical}from'lucide-react';import{Card,CardContent}from'@/components/ui/card';import{Badge}from'@/components/ui/badge';import{Button}from'@/components/ui/button';import{Select,SelectContent,SelectItem,SelectTrigger,SelectValue}from'@/components/ui/select';import{DropdownMenu,DropdownMenuContent,DropdownMenuItem,DropdownMenuTrigger}from'@/components/ui/dropdown-menu';import{Pagination}from'@/components/shared/navigation/Pagination';import{EmptyState}from'@/components/shared/feedback/EmptyState';import type{Agendamento}from'@/lib/api/server';import{formatCurrency}from'@/lib/api/server';import{useRouter}from'next/navigation';import Link from'next/link';interface Props{initialAgendamentos:Agendamento[];initialMeta:{total:number;page:number;size:number;pages:number}}const STATUS_COLORS={'pendente':'bg-yellow-100 text-yellow-700','confirmado':'bg-blue-100 text-blue-700','cancelado':'bg-red-100 text-red-700','concluido':'bg-green-100 text-green-700'};export function AgendamentosList({initialAgendamentos,initialMeta}:Props){const router=useRouter();const[statusFilter,setStatusFilter]=useState('all');const filtered=initialAgendamentos.filter(a=>statusFilter==='all'||a.nm_status===statusFilter);return<div className="space-y-6"><Card className="border-0 shadow-lg"><CardContent className="pt-6"><Select value={statusFilter}onValueChange={v=>{setStatusFilter(v);router.push(`/admin/clinica/agendamentos?status=${v}`)}}><SelectTrigger className="w-64"><SelectValue/></SelectTrigger><SelectContent><SelectItem value="all">Todos</SelectItem><SelectItem value="pendente">Pendente</SelectItem><SelectItem value="confirmado">Confirmado</SelectItem><SelectItem value="cancelado">Cancelado</SelectItem><SelectItem value="concluido">Concluído</SelectItem></SelectContent></Select></CardContent></Card><p className="text-sm text-gray-600">Total:<span className="font-semibold">{initialMeta.total}</span>agendamentos</p>{filtered.length===0?<EmptyState icon={Calendar}title="Nenhum agendamento"description="Agendamentos aparecerão aqui"action={{label:'Novo',href:'/admin/clinica/agendamentos/novo'}}/>:<div className="space-y-4">{filtered.map(a=><Card key={a.id_agendamento}className="group hover:shadow-lg transition-all border-0"><CardContent className="p-6"><div className="flex items-start justify-between"><div className="flex gap-4 flex-1"><div className="p-3 rounded-lg bg-gradient-to-br from-blue-100 to-indigo-100"><Calendar className="w-6 h-6 text-blue-600"/></div><div className="flex-1 space-y-2"><div className="flex items-center gap-3"><h3 className="font-semibold text-gray-900">{a.paciente?.nm_completo||'Paciente'}</h3><Badge className={STATUS_COLORS[a.nm_status]||''}>{a.nm_status}</Badge></div><div className="grid grid-cols-2 gap-x-6 gap-y-2 text-sm text-gray-600"><div className="flex items-center gap-2"><Clock className="w-4 h-4"/><span>{new Date(a.dt_agendamento).toLocaleDateString('pt-BR')} às {a.hr_agendamento}</span></div><div className="flex items-center gap-2"><User className="w-4 h-4"/><span>{a.profissional?.nm_completo||'Profissional'}</span></div>{a.procedimento&&<div className="flex items-center gap-2"><MapPin className="w-4 h-4"/><span>{a.procedimento.nm_procedimento}</span></div>}{a.procedimento?.vl_preco&&<div className="flex items-center gap-2"><DollarSign className="w-4 h-4"/><span>{formatCurrency(a.procedimento.vl_preco)}</span></div>}</div></div></div><div className="flex gap-2"><DropdownMenu><DropdownMenuTrigger asChild><Button variant="ghost"size="sm"><MoreVertical className="w-4 h-4"/></Button></DropdownMenuTrigger><DropdownMenuContent><DropdownMenuItem asChild><Link href={`/admin/clinica/agendamentos/${a.id_agendamento}`}>Ver Detalhes</Link></DropdownMenuItem><DropdownMenuItem><Check className="w-4 h-4 mr-2"/>Confirmar</DropdownMenuItem><DropdownMenuItem className="text-red-600"><X className="w-4 h-4 mr-2"/>Cancelar</DropdownMenuItem></DropdownMenuContent></DropdownMenu></div></div></CardContent></Card>)}</div>}{initialMeta.pages>1&&<Pagination currentPage={initialMeta.page}totalPages={initialMeta.pages}totalItems={initialMeta.total}pageSize={initialMeta.size}onPageChange={p=>router.push(`/admin/clinica/agendamentos?page=${p}`)}/>}</div>;}
