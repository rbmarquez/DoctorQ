FROM node:22-slim

# Definir timezone
ENV TZ=America/Sao_Paulo
ENV NODE_ENV=development

# Instalar pacotes necessários
RUN apt-get update -y \
  && apt-get install wget tzdata -y -qq \
  && apt-get clean \
  && rm -rf /var/lib/apt/lists/*

# Criar diretórios da aplicação
RUN mkdir -p /home/node/app /home/node/.npm

# Configurar permissões
RUN chown -R node:node /home/node/ \
  && chmod -R 777 /home/node/

# Configurar cache do npm
ENV NPM_CONFIG_CACHE=/home/node/.npm

USER node
WORKDIR /home/node/app

# Copiar apenas package.json e yarn.lock para instalar dependências
COPY --chown=node:node package.json yarn.lock ./
RUN yarn install

# Expor porta padrão do Next.js
EXPOSE 3000

# Comando padrão para desenvolvimento
CMD ["yarn", "dev"] 
